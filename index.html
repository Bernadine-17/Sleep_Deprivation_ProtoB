<!DOCTYPE html> 
<html> 
<!-- The following code has been developed by students and/or researchers of the Freshman Research Initiative DIY Diagnostics Stream at The University of Texas at Austin.  This code is shared for demonstration purposes and should not be considered a product -- it is for entertainment purposes only.  Any user of this code does so at their own risk. Members of the DIY Stream, FRI, and The University of Texas system are not liable for anything related to this code.
  
 
Authors in chronological order of contribution:
Alijah James
Emma Aldred
Tim Riedel
 
Further Information:
http://cns.utexas.edu/fri
 
Research Educator:
Timothy Riedel
triedel@utexas.edu
 
Brief Description of Goal of Code:
The goal is to create a web-based app that helps users who are likely to be college students determine if they are sleep deprived.
 
Known Issues:
ADD
https://www.w3schools.com/w3css/default.asp
https://stackoverflow.com/questions/8211128/multiple-distinct-pages-in-one-html-file
-->
	<head>
		<title>Sleep Deprivation</title> <!--overall title seen on tab-->
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!--<meta name="apple-mobile-web-app-capable" content="yes">-->
		<!--<link rel="stylesheet" href="w3.css">-->
		<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
		<!--<link rel="stylesheet" href="w3-colors-flat.css">-->
		<!--set up of the style of the web page-->
	</head>
		
	<script>
		var docMod = document.lastModified; // loads last modified time stamp into docMod variable
			alert("This file last modified " + docMod); // generates alert box with time stamp. If annoying, comment out this entire line.
			console.log("This file last modified " + docMod); // generates message in javaScript console (found in developers tools) with time stamp.
		
		var startTime, endTime; //variable to record time start and end
		var user_saccade=[]; //array variable to record list of times
		
		function start() {
			//alert("Start function is being called");
			startTime = new Date(); //calls start time
		}
		
		function draw(){
			var mycanvas;//variable set up to create a drawing canvas
			var mycontext;//variable to provide context to the above canvas
			mycanvas = document.getElementById("canvas"); //finds the canvas with the Id 'canvas'
			mycontext = mycanvas.getContext("2d"); //sets up the context of the function with 2d
			mycontext.beginPath();//start drawing circle
			mycontext.arc(325, 175, 10, 0, 2 * Math.PI);//dimensions of circle
			mycontext.stroke();//printing actual line
			mycontext.fillStyle = "red"; //defines fills with red 
			mycontext.fill(); //fills in circle
		}
		
		var i = 0; //counting variable to keep track of user's # of times recorded
		var width = 0; //initialized width
		
		function letter(){
			var randomletter = Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0,1).split('').map(c => Math.random() < 0.5 ? c.toUpperCase() : c).join('');
			//random letter
			var mycanvas = document.getElementById("canvas"); //finds the canvas with the Id 'a'
			var mycontext = mycanvas.getContext("2d"); //sets up the context of the function with 2dv

			if (i % 2 == 0){
				width = 1;//will print letter on left of canvas
			}

			else{
				width = 628;//will print letter on right of canvas
			}
			mycontext.font = "bold 24px sans-serif"; //determines the font of the text
			mycontext.fillStyle = "black"; //color for letter
			mycontext.fillText(randomletter,width,175); //declares and prints the text and gives placement
			i++;//adds to counting variable, adds one
			document.getElementById("trialcount").innerHTML = i;
		}
		
		var timeDiff;//variable to record difference in start and end time
		
		function end() {
			//alert("End function is being called");
			var g = 1000; //delay time in ms for letter
			endTime = new Date();//records new time
			timeDiff = endTime - startTime - g; //change in start and end time in ms
				// strip the ms
			timeDiff /= 1000;
				// get seconds 
			document.getElementById("time_list").innerHTML = timeDiff; //prints the timeDiff
			user_saccade.push(timeDiff);//adds timeDiff to the array
			document.getElementById("results").innerHTML = user_saccade; //prints list of time
			
		}
		
		function reset(){
			//alert("reset function is being called");
			var mycanvas = document.getElementById("canvas"); //finds the canvas with the Id 'a'
			var mycontext = mycanvas.getContext("2d"); //sets up the context of the function with 2d
			mycanvas.width=650; //resets canvas width to 650
			mycanvas.height=350; //resets canvas height to 350
		}
		
		function average(){
			var sum = user_saccade.reduce((previous, current) => current += previous);//sums list of times
			var avg = sum/user_saccade.length;//divides sum by the # of times in array to get average
			document.getElementById("avg").innerHTML = avg; //prints average
		}
			
	</script>
	
	<!--<style>
		.body {
     			margin: 0em;
		}
		.page {
   			width: 100vw;
    			height: 100vh;
    			position: fixed;
			top: 0;
			left: -100vw;
			overflow-y: auto;
			z-index: 0;
			background-color: hsl(0,0%,100%);
		}
  		.page:target {
			left: 0vw;
			z-index: 1;
		}
	</style>-->
	<!-- above sets the web-page's dimensions and look-->	
	
	<body>
		<!--<div id="header" class="w3-container w3-light-blue">
			<h1>Sleep Deprivation Diagnostic</h1>
		</div>-->
		<!-- Navbar (sit on top) -->
		<div class="w3-top">
			<div class="w3-bar w3-white w3-wide w3-padding w3-card">
				<a href="#home" class="w3-bar-item w3-button"><b>Sleep Deprivation Diagnostic</b> - DIY</a>
		<!-- Float links to the right. Hide them on small screens -->
    			<div class="w3-right w3-hide-small">
				<a href="#home" class="w3-bar-item w3-button">Home</a>
				<a href="#test" class="w3-bar-item w3-button">Test</a>
				<a href="#results" class="w3-bar-item w3-button">Results</a>
			</div>
			</div>
		</div>
		<header class="w3-display-container w3-content w3-wide" style="max-width:1500px;" id="home">
			<h1 class="w3-xxlarge w3-text-white">Sleep Deprivation Diagnostic</h1>
		<!--header displayed on top of web page-->
			
		<!--<div id="content" class= "w3-container"> <!--first page of app-->
		<!-- Page content -->
		<div class="w3-content w3-padding" style="max-width:1564px">
		
			<div class="w3-container w3-padding-32" id="home">
				<h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Projects</h3>
			</div>
			<p>Hold your phone sideways at an arms length distance from your face. When ready, press start and stare at the red dot. A black letter will flash on either side of the dot. 
				When you see this letter, press the stop button. This will record an individual saccade. Press reset to start again. Repeat this at least 20 times 
				before going to view your results for the most accurate diagnosis. Find the test under the "Test" tab above.</p>
			<!--prints instructions to use app-->
			<!--<p>Click here to go to the test</p><!--text of button-->
			<!--<a href="#one" class="w3-btn w3-light-blue w3-round"> Get Started </a>
			<!--button to take user to second page-->
			
			<!--<div class = "page" id= "one"> <!--new page-->
			<div class="w3-container w3-padding-32" id="test">
				<h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Test</h3>
				<!--<div id="header" class="w3-container w3-light-blue">-->
					<!--<h1>Sleep Deprivation Diagnostic</h1>-->
				<!--header at top of page "one"-->
				<!--<div id="content" class="w3-container">-->
					<!--below buttons call the functions listed within them when pressed-->
					<button onclick="start();draw();setTimeout(letter, 1000);">Start</button><!--setTimeout calls letter but delays by 1 sec-->
					<button onclick="end();">End</button>
					<button onclick="reset();">Reset</button>
				
					<canvas id= "canvas" width="650" height="350" style= "border:1px solid #000000;"></canvas>
					<!--creates canas-->
				<p id="time_list"></p><p>seconds</p><!--prints time difference-->
					<p>You have completed </p><p id="trialcount"></p><p> trials</p><!--prints the number of saccades recorded-->

					<!--<a href="#two" class="w3-btn w3-light-blue w3-round"> Go see results </a>-->
					<!--button to take user to next page-->
				<!--</div>-->
			</div>
			
			<!--<div class = "page" id= "two">-->
			<div class="w3-container w3-padding-32" id="results">
				<h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Results</h3>
				<!--<div id="header" class="w3-container w3-light-blue">
					<h1>Sleep Deprivation Diagnostic</h1>
				</div>-->
				<!-- header for page "two"-->
				<!--<div id="content" class="w3-container">-->
					<p>Here is a list of all your individual saccade times</p>
					<p id="results"></p>
					<!--prints description and of list of individual time differences-->
					<button onclick="average();">Get Average</button>
					<!--calls function to calculate average-->
					<p id="avg"></p>
					<!--prints average-->
				<!--</div>-->
			</div>
		
		</div>
		
		<footer class="w3-center w3-black w3-padding-16">
			<p>DIY Diagnostics</p>
		</footer>
		
		<!--<div data-role="footer" data-position="fixed">
      			<p>DIY Diagnostics</p>
    		</div>
		<!-- footer -->
  	 </body>
</html>
